<html>
  <head>
    <meta charset = "utf-8">
    <link rel = "stylesheet" href = "default.css">
  <head>
    <body>
      <h1>PEDを用いた多型検出</h1>
      ショートカット 
	  <a href = "https://akiomiyao.github.io/ped/covid19/index.html" target = "_blank">[COVID-19特設サイトはこちら]</a>
	  <a href = "https://akiomiyao.github.io/ped/human/index.html" target = "_blank">[ヒトの解析例]</a>
	  <a href = "https://akiomiyao.github.io/ped/rice/index.html" target = "_blank">[イネの解析例]</a>
	  <a href = "https://akiomiyao.github.io/ped/lotus/index.html" target = "_blank">[ミヤコグサの解析例]</a>
	  <a href = "https://akiomiyao.github.io/ped/arabidopsis/index.html" target = "_blank">[アラビドプシスの解析例]</a>
     <h2>PEDとは</h2>
      <p>Polymorphic Edge Detection (PED)は、DNAの多型のキワ(エッジ)に着目して効率よく多型を検出する方法です。非常に正確にSNPとindel等構造変異を得ることができます。
      <p>次世代シーケンサーの配列を解析する場合、まず配列(ショートリード)をリファレンスゲノム配列にマップして、不一致の部分を抽出するのが一般的ですが、大部分のショートリードは多型を含まないため効率はあまりよくありません。
      <p>PEDでは、ショートリードから多型のエッジになる部分を早い段階で抽出するアルゴリズムで、これまでにない新しい手法です。
      <p>エッジを検出する方法として、<a href = "https://bmcbioinformatics.biomedcentral.com/articles/10.1186/s12859-019-2955-6/figures/1" target = "_blank">ショートリードを長さk(<i>k</i>=20)の細かい断片に分解してターゲットとコントロールのショートリードを直接比較して多型を検出する方法(<i>k</i>-mer法)</a>と、ショートリードに対してリファレンスゲノム配列を5'側からと3'側から双方向に整列してエッジを検出する双方向整列法(Bidirectional Alignment法)の2つのアルゴリズムを実装しています。
      <p><i>k</i>-mer法はリファレンス配列がなくても、3'末端に多型を持つ<i>k</i>-merを抽出することができ、連鎖解析に利用できます。
      <p><a href = "https://bmcbioinformatics.biomedcentral.com/articles/10.1186/s12859-019-2955-6/figures/2" target = "_blank">双方向整列法は、SNPに加えて、挿入、欠失、逆位、転座などの構造変異が同時に検出されます。</a>また、従来法に比べて正確かつ高速に処理することができ、特に数100kbを超えるような大きな欠失も正確に検出できる特徴があります。
      <p>シンプルなアルゴリズムなので、ヒトの5倍の大きさで6倍体ゲノムのコムギのような複雑なゲノム構成の生物の多型も検出できます。また、小規模なコンピュータリソースで動作が可能です。<br>

	<a name = "simple_tutorial">
	<h2>ped.plでの多型検出 (簡単なチュートリアル)</h2>
	 <ul>
	  <li>ped.plは、マルチスレッド(マルチプロセス)で高速に解析できます。Linuxをインストールした4コアや8コア等のマルチコアCPUのコンピュータでの実行に適しています。<br>
	  時間はかかりますが、シングルコアや2コアのCPUでも動作します。<br>
	  メモリーは4Gバイト以上、ディスクはヒトを解析する場合は1TB程度必要です。コードは<a href = "https://github.com/akiomiyao/ped" target = "_blank">Github</a>から、実行に必要なファイルが設定ずみのDockerのコンテナも公開しています。AWSやGCP等のクラウドで実行できます。<br>
	  <p><b>書式</b><br>
	  perl ped.pl target=target,control=control,ref=reference
      <ul>
      <li>githubからpedスクリプトを取得すると、pedディレクトリの中にスクリプトのセットがダウンロードされます。
      <li>上記の場合は、ped.plがあるディレクトリにターゲットとコントロールのディレクトリを作成し、それぞれのディレクトリの中にreadというディレクトリを作成し、その中にそれぞれのfastqファイルを保存します。
	  <li>ped.plの半角スペースの後に,で区切ってまとめて指定します。,の後ろにスペースを入れることはできません。
      <li>コントロールを指定しない場合は、リファレンスのゲノム配列をコントロールとして多型(リファレンスゲノムに対する多型)を検出します。
	  <li>gz, bz2, xz等の拡張子のついた圧縮ファイルもそのまま解析できます。
	  <li>初回の実行でリファレンスデータが見つからない場合、ダウンロードして自動作成します。
      <li>多型部分を増幅するプライマー配列も同時に出力されます。
      </ul>
      <li><b>Githubからのコードの取得は、</b><br>
      sudo apt install git (Ubuntuの場合)<br>
      sudo yum install git (CentOSの場合)<br>
      sudo pkg install git (FreeBSDの場合)<br>
      でgitをインストールした後に、<br><br>
      git clone https://github.com/akiomiyao/ped.git
      <br><br>
      curlも必要です。インストールされていない場合は、以下を実行してください。<br>
      sudo apt install curl (Ubuntuの場合)<br>
      sudo yum install curl (CentOSの場合)<br>
      sudo pkg install curl (FreeBSDの場合)<br>
 
	  <li><b>実行例</b>
	  <ul>
	  <li>perl ped.pl target=ERR194146,ref=hg38<br>
	  ヒトのhg38のリファレンスに対して、イルミナのプラチナゲノム配列の一つERR194146(CEPH/UTAH家系の父親)の多型を検出します。
      <li>docker run -v `pwd`:/work -w /ped akiomiyao/ped perl ped.pl target=DRR054198,ref=IRGSP1.0,wd=/work<br>
      Dockerのコンテナを用いて、イネのIRGSP1.0のリファレンスに対するコシヒカリ(DRR054198)の多型を検出します。Dockerの設定は、<a href = "#Docker_install">こちら</a>
	  <li>perl ped.pl target=SRR11513115,ref=COVID19,clipping=146<br>
	  長さが不揃いなRT-PCRの配列データを146塩基にそろえて、新型コロナウイルスのリファレンス配列に対する多型を検出します。
	  <li>perl ped.pl target=ERR3063487,control=ERR3063486,ref=WBcel235<br>
	  線虫の継代サンプルERR3063487と継代元サンプルERR3063486で継代によって発生した自然突然変異の検出の場合。
	  <li>perl ped.pl target=ERR3063487,control=ERR3063486,ref=WBcel235,wd=/home/your_id/data<br>
      ショートリードデータやリファレンスデータの入ったディレクトリを置く作業ディレクトリを/home/your_id/dataに指定する場合です。<br>
      指定しない場合は、ped.plがあるディレクトリが作業ディレクトリになります。
	  <li>perl ped.pl target=ERR3063487,control=ERR3063486,ref=WBcel235,thread=14<br>
	  最大スレッド数を指定する場合。<br>
      通常指定する必要はないですが、1スレッドで64ファイルをオープンする場合があるので、OSのファイルオープン数に上限がある場合は、スレッド数を抑える必要があります。<br>
      最大値はLinux OSのデフォルトファイルオープン上限(1024)に収まる14スレッドです。デフォルトは8スレッドとなっています。<br>
      ※ perlのスレッドのモジュールはメモリーリークを起こすことがわかりました。通常は問題ないのですが、PEDのように大きなデータのソートを行う場合はエラーが発生する場合があります。<br>
      スレッドの代わりに、別プロセスで実行するようにしたところ問題が回避されることがわかりましたので、現在はスレッドの代わりにプロセスで実行するように変更しました。<br>
      オプション名は、混乱をさけるためthreadのままにしてあります。
	  <li>perl ped.pl target=ERR3063487,control=ERR3063486,ref=WBcel235,tmpdir=/mnt/ssd<br>
	  一時ファイル置き場に高速ディスクを指定する場合。
	  <li>perl ped.pl target=ERR3063487,control=ERR3063486,ref=WBcel235,method=kmer<br>
	  <i>k</i>-mer法で解析する場合。デフォルトは双方向整列法。
      <li>オプションは,で区切って複数組み合わせて指定することができます。ただし、同じ名称のオプションの重複指定はできません。,の前後にスペースを入れることもできません。
	  </ul>
	 <li><b>デモ</b>　データのサイズが小さく数時間で結果が確認できますので、動作の確認には以下の線虫のデータセットをお勧めします。
	 <ul>
     <li>ERR3063486とERR3063487のfastqファイルのダウンロードとディレクトリのセットアップは、<br>
        pedのディレクトリ内で、<br>
        perl download.pl accession=ERR3063486<br>
        perl download.pl accession=ERR3063487<br>
        を実行します。(アメリカからのダウンロードなので、数時間程度かかります。fastq-dumpが必要です。インストール法は<a href = "#fastq-dump">こちら</a>)<br>
        dockerで実行する場合は、<br>
        docker run -v `pwd`:/work -w /ped akiomiyao/ped perl download.pl accession=ERR3063486,wd=/work<br>
        docker run -v `pwd`:/work -w /ped akiomiyao/ped perl download.pl accession=ERR3063487,wd=/work<br>
        を実行します。<br>
        このデモでは、線虫のコントロール(ERR3063486)に対して、250世代後の線虫(ERR3063487)に生じた自然突然変異をWBcel235のリファレンスゲノムを用いてbidirctional法で検出しています。<br>
        pedのディレクトリ内で、<br>
        perl ped.pl target=ERR3063487,control=ERR3063486,ref=WBcel235<br>
        あるいは、
        docker run -v `pwd`:/work -w /ped akiomiyao/ped perl ped.pl target=ERR3063487,control=ERR3063486,ref=WBcel235,wd=/work<br>
        とすると、現在のカレントディレクトリ上に存在するERR3063486、ERR3063487、WBcel235のディレクトリ内のファイルが解析対象になります。<br>
        結果は、ターゲットのERR3063487のディレクトリに結果が出力されます。<br>
        
	 <li>targetのディレクトリに以下の結果がまとめて出力されます。
	 <table>
	 <tr><td>target.vcf</td><td>HとMでマークされた多型をvcf形式で出力されたファイル</td></tr>
	 <tr><td>target.aln</td><td>双方向整列法による整列データ</td></tr>
	 <tr><td>target.bi.snp</td><td>双方向整列法によるSNPリスト　確度の高いSNPはH(ヘテロ)とM(変異型ホモ)でマークされます</td></tr>
	 <tr><td>target.bi.primer</td><td>双方向整列法によるSNPリストに加えてプライマー配列が出力されます</td></tr>
	 <tr><td>target.kmer.snp</td><td><i>k</i>-mer法で検出されたSNPリスト</td></tr>
	 <tr><td>target.kmer.primer</td><td><i>k</i>-mer法で検出されたSNPリストに加えてプライマー配列が出力されます</td></tr>
	 <tr><td>target.sv</td><td>双方向整列法で検出された構造(挿入・欠失・逆位・転座)変異リスト</td></tr>
	 <tr><td>target.sv.primer</td><td>双方向整列法で検出された構造(挿入・欠失・逆位・転座)変異リストに加えてプライマー配列が出力されます</td></tr>
	 <tr><td>target.index</td><td>アラインメント検索用インデックスファイル</td></tr>
	 </table>
	 targetの部分はターゲットとして指定したディレクトリ名となります。
	 <li>検出された多型をアラインメントに戻って確認したい場合は、<br>
	 perl search.pl target=target,chr=chromosome,pos=position<br>
	 を実行します。<br>
	 <b>例</b><br>
     perl search.pl target=ERR3063487,chr=II,pos=948033<br>
     Dockerコマンドで実行する場合は、<br>
	 docker run -v `pwd`:/work -w /ped -t akiomiyao/ped perl search.pl target=ERR3063487,chr=II,pos=948033,wd=/work
	 </ul>
	 </ul>


     <h2>結果のフォーマット</h2>
     <ul>
           <li>以下は、ヒト (イルミナ プラチナゲノムの配列データ ERR194146)の出力例です。<br>
           ERR194146のディレクトリの中にERR194146.vcf
           というvcf形式マップデータがセーブされます。<br>
<pre>##fileformat=VCFv4.2
##INFO=&lt;ID=AF,Number=.,Type=Float,Description="Allele Frequency">
##INFO=&lt;ID=DP,Number=1,Type=Integer,Description="Approximate read depth)">
##INFO=&lt;ID=END,Number=1,Type=Integer,Description="End position of the variant described in this record. Edge position of the alignment from 3'-end of short read is shown as END.">
##INFO=&lt;ID=GT,Number=1,Type=String,Description="Genotype">
##INFO=&lt;ID=HOMLEN,Number=.,Type=Integer,Description="Length of base pair identical micro-homology at event breakpoints">
##INFO=&lt;ID=HOMSEQ,Number=.,Type=String,Description="Sequence of base pair identical micro-homology at event breakpoints">
##INFO=&lt;ID=PCRLEN,Number=.,Type=Integer,Description="PCR product length">
##INFO=&lt;ID=PL,Number=.,Type=String,Description="Left primer sequence">
##INFO=&lt;ID=PR,Number=.,Type=String,Description="Right primer sequence">
##INFO=&lt;ID=SVLEN,Number=.,Type=Float,Description="Difference in length between REF and ALT alleles">
##INFO=&lt;ID=SVTYPE,Number=1,Type=Integer,Description="Type of structural variant">
##ALT=&lt;ID=DEL,Description="Deletion">
##ALT=&lt;ID=INS,Description="Insertion of novel sequence">
##ALT=&lt;ID=INV,Description="Inversion of reference sequence">
##FORMAT=&lt;ID=GT,Number=1,Type=String,Description="Genotype">
##FORMAT=&lt;ID=AD,Number=.,Type=Integer,Description="Allelic depths for the reference and alternate alleles in the order listed">
##FORMAT=&lt;ID=DP,Number=1,Type=Integer,Description="Read depth">
##source=&lt;PROGRAM=ped.pl,Method="Bidirectional method",target=ERR194146,control=hg19,reference=hg19>
##created=&lt;TIMESTAMP="2020-05-07 19:45:32 +0900">
#CHROM  POS     ID      REF     ALT     QUAL    FILTER  INFO    FORMAT  ERR194146
1       69511   .       A       G       1000    .       GT=1/1;AF=1;DP=19;PL=TGTGTGGCAACGCATGTGTC;PR=CAACTGGCTCACCGAATGGA;PCRLEN=74     GT:AD:DP        1/1:0,19:19
1       564654  .       G       A       1000    .       GT=0/1;AF=0.534;DP=43;PL=CTCTCCCCTGAACTCTACAC;PR=CGGGGGTATGCTGTTCGAAT;PCRLEN=89 GT:AD:DP        1/1:20,23:43
1       564655  .       A       C       1000    .       GT=0/1;AF=0.343;DP=32;PL=CTCTCCCCTGAACTCTACAC;PR=CGGGGGTATGCTGTTCGAAT;PCRLEN=89 GT:AD:DP        1/1:21,11:32
1       564898  .       A       C       1000    .       GT=0/1;AF=0.313;DP=67;PL=TCCAGCATTCCCCCTCAAAC;PR=GGTGGCACGGAGAATTTTGG;PCRLEN=144        GT:AD:DP        1/1:46,21:67
1       565006  .       T       C       1000    .       GT=0/1;AF=0.666;DP=57;PL=TAAGCTATCGGGCCCATACC;PR=GGTTGGGCCAGGGGATTAAT;PCRLEN=72 GT:AD:DP        1/1:19,38:57
1       565006  .       T       G       1000    .       GT=0/1;AF=0.666;DP=57;PL=TAAGCTATCGGGCCCATACC;PR=GGTTGGGCCAGGGGATTAAT;PCRLEN=72 GT:AD:DP        1/1:19,38:57
1       565454  .       T       C       1000    .       GT=0/1;AF=0.347;DP=23;PL=CCTGCTCCTTCTCACATGAC;PR=GAGTGAGGAGAAGGCTTACG;PCRLEN=89 GT:AD:DP        1/1:15,8:23
1       565464  .       T       C       1000    .       GT=0/1;AF=0.514;DP=35;PL=CCTGCTCCTTCTCACATGAC;PR=GAGTGAGGAGAAGGCTTACG;PCRLEN=89 GT:AD:DP        1/1:17,18:35

1       833173  .       C       CGAAC   1000    .       SVTYPE=INS;END=833173;SVLEN=4;PL=GCTTGCTGAATTCCTGCCTG;PR=GAGGACTGTGGGCGAAAAGT;PCRLEN=73;GT=0/1;AF=0.473;DP=38   GT:AD:DP        0/1:20,18:38

1       867997  .       CTTTC   C       1000    .       SVTYPE=DEL;END=867998;HOMLEN=4;HOMSEQ=TTTC;SVLEN=-4;PL=CTCCCAGACCATGTCTGTGT;PR=AACACACAGATGGAGGTGGC;PCRLEN=85;GT=1/1;AF=0.969;DP=33     GT:AD:DP        1/1:1,32:33
</pre>
           PEDでは、bwaを使わず独自の方法でマッピングしているため、bwa/GATKと同様のクオリティースコアの算出が困難です。<br>
           そのため、クオリティースコアは1000の固定値としています。<br>
           多型のクオリティーは、サポートされるリードのカバー数(DP)で判断して下さい。<br>
転座に関してはIntegrative Genome Veiwer(IGV)でうまく表示できないので含めていません。同時に出力されるsvのファイルをご参照ください。
          <li> ERR194146.bi.primerでは多型部分を増幅するプライマーセットも出力されます。<pre>
1       1223251 A       G       50      0       0       26      M       GCTGAGCACTCACTTTCCTC    ATAGCGAGAAGGAGGTTGCC    76      CACACGGCACGCACACACGTACTCACGAGCACACGCACGGCACACTCATACACGACACACACGGCACACTCATGTACACACAACACACGCGCGCACACACAGGATGCCTGAGACCGGTGGCGGGAGCCTGGCTGAGCACTCACTTTCCTC[G/A]TCCACTTTGAGTTCCTCGTTGAGCCTGATGGCGTCGGCAACCTCCTTCTCGCTATGGCCTTTACTCGCCAAAAACTTCACCTTATACTCGTCCCAAGACACGTGACCTGGAAGAGCAGATCACACCTGTCAGGGCCTCTGATACTGAGC
1       1224137 T       C       50      0       0       26      M       TCCACCAGGCAACGCGAAAA    TTCTGTGTGACAGAGGGGGA    137     GCAGGTGGCCGTCAGACTGGGCCCCCAGGACCCCGAACAGCCAGACGGATGCCGCCGGCCCAGGACTCCATGGCTGCGTGAACCTGCCACCAACAGCGACAGGCTCCACCAGGCAACGCGAAAAGCGTCCGGGACGTGGGGCTTGTGGGG[C/T]GCCGGGCCACGCCAGAGACACTGGGGAAGGTGGATGCCACGGTCCCCTCCCCGGGGAAACACATGGACCCTCCCCCTCTGTCACACAGAATCACCACCAGACCCCACTCTCCAACCACAGCTTCCAAAAGTCACACTCTTCACGTTTTA
1       1224160 G       A       50      0       7       14      H       TCCACCAGGCAACGCGAAAA    TTCTGTGTGACAGAGGGGGA    137     CCCAGGACCCCGAACAGCCAGACGGATGCCGCCGGCCCAGGACTCCATGGCTGCGTGAACCTGCCACCAACAGCGACAGGCTCCACCAGGCAACGCGAAAAGCGTCCGGGACGTGGGGCTTGTGGGGTGCCGGGCCACGCCAGAGACACT[A/G]GGGAAGGTGGATGCCACGGTCCCCTCCCCGGGGAAACACATGGACCCTCCCCCTCTGTCACACAGAATCACCACCAGACCCCACTCTCCAACCACAGCTTCCAAAAGTCACACTCTTCACGTTTTATTTTATTTTTTGAGATGGAGTCT
1       1224783 G       A       50      0       19      16      H       GGAGACCCCACCTCTACAAA    GTAGCTGAAACCACAGGTGC    74      AGGACGCAGTGGCCACACCTATAATCCCAGCCCTTTGGGAGGCTAAGACAGGTGGATCACTTAAGCCCAGAAGTTCAAGACCAGCTTGGGCAACATAGGGAGACCCCACCTCTACAAAAACAATTACGAAAATTCGCCAGGCGCGGTGGC[A/G]TGCACCTGTGGTTTCAGCTACTCAAGAGGCTGAGGTGGGAGGCCTCCCGAACCTGGAATGCGAAGGTTGCAGTGAACTGTGATCACACCACTGCACTCCAGCCTGGGCGGCATACCGAGACCCTGACTCAAAACAAGACAAAACAAAAT
</pre>
           左から、<br>
           <ol>
           <li>染色体番号
           <li>位置
           <li>リファレンス塩基
           <li>変異型塩基
           <li>リファレンス型のコントロール(この場合hg38から作成したコントロール配列)のリード数
           <li>変異型のコントロールのリード数
           <li>リファレンス型のターゲット(ERR194146)のリード数
           <li>変異型のターゲットのリード数
           <li>ホモ・ヘテロ型判定です。一番右にMと表示されている行がホモ変異、Hがヘテロと判定しています。
           <li>Left primer
           <li>Right primer
           <li>増幅断片長
           <li>多型の前後300bpの配列情報
           </ol>
           <p><ul>
           <li>コントロールを指定しないで、リファレンスをコントロールとした場合、コントロールのリード数は、リファレンスから作成した疑似リードでのデプスが値に入ります。
           <li>双方向整列法では、反復領域のアラインは最初から除外します。2行目は除外されなかった、つまり反復配列領域でない部分のアラインの変異情報からリードのデプスを検証したところ、<br>
ターゲット(ERR194146)では、26リードが変異型で検出されたことがわかります。hg38から作成したコントロール配列では、リファレンス型が50リードで変異型は検出されていません。
           </ul>
           <li>構造変異とそのプライマー配列は、ERR194146.sv.primer<br>
           に出力されます。
           <pre>1       36936824        1       36936812        f       insertion       1       50      0       33      15      H       TTTTTTTTTT      GCATGCTAGGGGCTGTTAAG    CCGCACCTGTTGTTGTATCC    181     GAATGTCAGACTTTAACCTC TGATGGAACATTGGGATGAG
1       36939873        1       36939870        f       insertion       1       50      0       1       36      M       C       ATCAGAGGGGGACCCTTGTT    AGATGACTGTGTCAGGAGGG    73      AGGCCTGGTCCACTACCACT TTGTCCCTGGGCCCTCCTGA
1       36957834        1       36958209        f       deletion        -397    50      0       7       5       H       TGTGTCCCGTGAGCCTGTGTG   GAACCTATGTGTCCCGTGAG    AGTCATGGGACACACAGGCT    79      GTGTCCCGTGAGCCTGTGTG TGTGCCCCGTGAGCCTGTGT
1       36959937        1       36959973        f       deletion        -47     50      0       0       13      M       TGCCCCATGA      ATTCTGTGCCCCATGAGCCT    TATGGGGCACACAGACTCAC    85      TGAGCCTGTGTGCCCCATGA TGCCCCATGAGCCTCTGTGC
1       36962666        1       36962642        f       deletion        -2      50      0       8       12      H       AGAGAGAGAGAGAGAGAGAGAGAGA       GTGAGAGAGAGGGAGAGGAA    CCCTCTCTTTGCCTCTCCAT    84      GTGAGAGAGAGGGAGAGGAA AACAGAAGTGAACAAAAAGT
1       36968265        1       36968222        f       deletion        -2      50      0       11      7       H       GTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGTGT    CCTCACAGTTTCACCTGCTC    AGGGAGCATGAACAGAGGGA    106     TCTTTCACTCTCTCTCTCCG TCTTCTTTGTTTCCCTCTGT
1       36986463        1       36986416        f       insertion       4       50      0       7       9       H       TCCATCCATCCATCCATCCATCCATCCATCCATCCATCCATC      CCATCCATCCATCCATCCTG    TGGATGGATGGATGGATGGG    78      CATCCTGTCCCCATCTCTCT GCCCATCCATCCATCCATCC
1       37001890        1       37001895        f       deletion        -9      50      0       25      25      H       GGA     AGCTCAGTCTTACCACTGGG    TCACAACCCCAGCTTCCTCT    70      CTCAGTCTTACCACTGGGGA GGAGACAATGTGGAACTGCC
</pre>
         左からタブ区切りで、<br>
         <ol>
         <li>5'側からアラインした場合の染色体番号
         <li>5'側からアラインした場合の最初にギャップが現れた位置
         <li>3'側からアラインした場合の染色体番号
         <li>3'側からアラインした場合の最初にギャップが現れた位置
         <li>3'側からアラインした場合の染色体の向き
         <li>挿入(insertion)、欠失(deletion)、逆位(inversion)、転座(translocation)の種別
         <li>挿入塩基数、あるいは、欠失塩基数
         <li>コントロールのfastq配列に対する、リファレンス型配列を持つリード数
         <li>コントロールのfastq配列に対する、変異型配列を持つリード数
         <li>ターゲットのfastq配列に対する、リファレンス型配列を持つリード数
         <li>ターゲットのfastq配列に対する、変異型配列を持つリード数
         <li>ホモ型(M)、ヘテロ型(H)の種別
         <li>5'側からのギャップと3'側からのギャップに挟まれた部分の配列
         <li>Left primer
         <li>Right primer
         <li>増幅断片長
         <li> 多型部分の上流20塩基と下流20塩基の配列セット
         </ol>
         となります。
         <li>translocationに関しては、散在しているリファレンスゲノム上の反復配列で比較的多くのSNPがある場合、それぞれユニークな配列として認識されます。対象配列の反復配列にさらにSNPが入った場合、別の染色体に存在している反復配列領域と偶然認識される場合があります。あるいは、ERR194146配列のもとになったDNAは、培養細胞由来なので長期間の培養の間に、一部の細胞に変異が入った可能性も考えられます。反復配列領域の確認はサザンハイブリダイゼーションでは、スメアになり転座の確認は困難です。対象部位の上流と下流で確実にユニークと思われる部分にプライマーを設計して、PCRで想定サイズの断片が増幅されれば、転座の確認ができます。
         <li>数塩基の挿入・欠失は、1～数塩基の単純反復配列の反復数の変動の場合が多いです。最後のカラムは、検出されたエッジに挟まれた部分の配列で、この部分に反復配列が認められる場合は、単純反復配列の反復数の変動です。
         </ul>
      </ul> 

     </ul>


	 <h2>サポートしているリファレンスゲノム</h2>
	 <ul>
	 <li>perl ped.pl と引数なしに実行すると、使用法とサポートしているリファレンスゲノムが表示されます。<br>
	 ref=nameのように表示されたゲノムの名前を指定すると、配列公開サイトから自動的にダウンロードして、データセットが生成されます。<br>
	 一度作成されると次回以降の実行では、作成されたデータセットをもとに解析が進みます。
	 <li>現在サポートしているリファレンスゲノムは以下の通りです。
	 <pre>  Name           Description
  Asagao1.2      Asagao (Ipomoea nil) Japanese morning glory
  B73v4          Corn (Zea mays B73) RefGen v4
  Bomo           Silkworm (Bombyx mori) Genome assembly (Nov.2016)
  COVID19        Severe acute respiratory syndrome coronavirus 2 (CIVID-19, NC_045512.2)
  GRCm38         Mouse (Mus musculus) Genome Reference Consortium Mouse Build 38
  Gmax275v2.0    Soybean (Glycine max) genome project assemble version 2
  IBSC2          Barley (Hordeum vulgare L. cv. Molex) Release 44
  IRGSP1.0       Rice (Olyza sativa L. cv. Nipponbare) version 1.0
  IWGSC1.0       Wheat (Triticum aestivum L. cv. Chinese Spring) Version 1.0
  LJ3            Lotus japonicus MG20 v3.0 (Download from https://lotus.au.dk/data/download into LJ3 directory)
  SL3            Tomato (Solanum lycopersicum cv. Heinz 1706) Build 3.0
  SScrofa11.1    Pig (Sus scrofa) Release-97
  TAIR10         Arabidopsis thaliana version TAIR10
  UMD3.1         Cow (Bos taurus L1 Dominette 01449) UMD 3.1
  WBcel235       Caenorhabditis elegans WBcel235
  danRer11       Zebrafish (Danio rerio) Genome Reference Consortium Zebrafish Build 11
  dmel626        Drosophila melanogaster
  hg19           Human (Homo sapiens) Genome Reference Consortium Human Build 19
  hg38           Human (Homo sapiens) Genome Reference Consortium Human Build 38
</pre>
     <li>サポートされていないリファレンス配列で解析したい場合
     <ul>
     <li>任意のリファレンスの名称のディレクトリを作り、その中にfastaファイル(multi-fasta形式、圧縮可、名称は任意)を置きます。
     <li>染色体名は、番号とX、Y、Zのように単純なものにした方が、後々の解析が楽になります。
     <li>perl ped.pl target=target,control=control,ref=directory_name,file=file_name<br>
     で任意のリファレンスのデータセットが生成されて解析が進みます。
     </ul>
	 </ul>
	 <a name = "Docker_install">
	 <h2>Dockerのインストール</h2>
	 CentOSやUbuntuにインストールする場合<br>
     <ul>
	 <li>参照 <a href = "https://docs.docker.com/install/linux/docker-ce/ubuntu/#install-using-the-convenience-script" target = "_blank">https://docs.docker.com/install/linux/docker-ce/ubuntu/</a><br>
	 <li>curl -fsSL https://get.docker.com -o get-docker.sh<br>
     sudo sh get-docker.sh<br>
     を実行します。<br>
     Ubuntuの場合は、<br>
     sudo apt install docker.io<br>
     でインストールできます。
     <li>sudo docker pull akiomiyao/ped<br>
     でコンテナをダウンロードすることができます。
     <li>コンテナを起動した後、途中で止めたい場合は、<br>
     sudo docker stats<br>
     で、止めたいコンテナのCONTAINER IDを調べて、<br>
     sudo docker kill CONTAINER_ID<br>
     を実行します。
     <li>suやsudoをしないでユーザの権限で実行したい場合は、<br>
     sudo usermod -a -G docker username<br>
     を実行(usernameは対象となるユーザのログイン時のIDになります)して、一旦ログアウトして、ログインしなおすとユーザ権限で実行できるようになります。<br>
     <li>ped.pl は複数のサブプロセスを生成します。docker のコンテナ内で実行すると、サブプロセス終了のシグナルがうまく伝わらない場合があり、実行が進むにつれてゾンビプロセスの数が増える現象が観察されます。<br>
     docker run --init のように --init オプションをつけて実行すると、ゾンビプロセスは増えませんが、今度は sort コマンド等が終わらないうちに、サブプロセスが終了する場合もあるようです。<br>
     一連の解析が終わるとゾンビプロセスもなくなりますので、大きな影響はないと考えていますが、気になる方は、docker ではなく github からスクリプトをクローンして ped.pl を直接実行することをお勧めします。
     </ul>


      <h2>PEDのインストール</h2>
      <p>以下の説明は、マルチスレッドで動作するシングルコンピュータ用のped.pl作成以前の説明です。<br>
      ped.plを用いる場合は、上記の操作法「<a href = "#simple_tutorial">ped.plでの多型検出 (簡単なチュートリアル)</a>」ですべての解析ができます。<br>
      ped.pl作成以前から利用されているユーザのために残してあります。
      <p>Unix (LinuxあるいはFreeBSD)がインストールされたコンピュータが必要です。シングルおよびコンピュータクラスタ双方の解析ソフトウェアがあります。
      <ul>
	<li>プログラムのダウンロード<br>
	  <a href = "https://github.com/akiomiyao/ped" target = "_blank">https://github.com/akiomiyao/ped</a>にアクセスして、<br>
	  Clone or downloadのプルダウンメニューよりzipファイルをダウンロードする。あるいは、<br>
	  git clone https://github.com/akiomiyao/ped.git<br>
	  を実行します。
	<li>以後の作業は、展開されたpedあるいはped-masterのディレクトリで作業します。git cloneで展開した場合は、展開したディレクトリで<br>
	  git pull<br>
	  を実行すると、最新のスクリプトに同期されます。
	  </ul>
	<h2>リファレンスゲノムデータセットの作成</h2>
	<ul>
	  <li>ped.plの場合は、実行初回に自動実行されるので、別途作成する必要はなくなりました。以下の作業は、ped.plではなく、bidirectional.plやkmer.plを実行する場合のみ必要です。
	  <li>引数なしで実行するとヘルプと対応しているゲノムがリストされます。<br>
	  perl mkref.pl<br>
	  <li>イネ(日本晴)データセットは、<br>
	  perl mkref.pl IRGSP1.0<br>
	  を実行します。<br>
	  <li>IRGSP1.0をhg38にするとヒトのデータセットができます。<br>
	  perl mkref.pl hg38<br>
	  ヒトの場合はサイズが大きいので、作成に1日程度かかります。<br>
	  <li>サーバーがFTPで外部と接続できない場合は、公開サイトからゲノムデータをダウンロードできない場合があります。<br>
      この場合は、ブラウザ経由で別途ゲノムデータをダウンロードして、リファレンス用のディレクトリに移して再実行すると処理を続けることができます。
	</ul>
    <a  name = "fastq-dump">
	<h2>fastq-dumpのインストール</h2>
	<ul>
	  <li><a href = "https://trace.ncbi.nlm.nih.gov/Traces/sra/sra.cgi?view=software" target = "_blank">https://trace.ncbi.nlm.nih.gov/Traces/sra/sra.cgi?view=software</a><br>
	  から、コンパイルされた実行ファイルのアーカイブをダウンロードします。<br>
	  <li>OSがCentOSなら、CentOS Linux 64 bit architecture - non-sudo tar archiveをダウンロードします。<br>
      クラウドを使わないのであれば、2.9.6-1をダウンロードしてください。最新版は、最初にクラウド関連の設定をする必要があります。<br>
	  tar xvzf ファイル名<br>
	  で展開できます。<br>
	  tar xvzf sratoolkit.2.10.0-centos_linux64.tar.gz<br>
	  <li>展開されたディレクトリの中のbinの中にある、fastq-dump-orig.2.10.0をユーザのホームディレクトリのbinディレクトリにfastq-dumpというファイル名でコピーします。<br>
	  例<br>
	  cp sratoolkit.2.10.0-centos_linux64/bin/fastq-dump-orig.2.10.0 ~/bin/fastq-dump
	  </ul>
	<h2>Fastqデータの取得</h2>
	<ul>
	<li>解析対象のfastqデータ<br>
	  日本晴 <a href = "https://www.ncbi.nlm.nih.gov/sra/?term=DRR099989" target = _blank">DRR099989</a><br>
	  コシヒカリ <a href = "https://www.ncbi.nlm.nih.gov/sra/?term=DRR054198" target = _blank">DRR054198</a><br>
	<li>download.plを実行します。<br>
	  perl download.pl DRR099989<br>
	  perl download.pl DRR054198<br>
	<li>pedのディレクトリの中に、DRR054198とDRR099989のディレクトリが作成され、その中のreadのディレクトリの中にfastqファイルがダウンロードされます。<br>
	  fastqファイルは、gz形式やbz2形式で圧縮されていても、そのまま解析が可能です。<br>
	  ターゲット名のディレクトリ下のreadディレクトリの中に置いたファイルがまとめて解析されます。<br>
	  ペアエンドのデータでも複数のシングルエンドのデータでも解析されますが、ファイルの圧縮形式は揃っている必要があります。<br>
	 <li>PEDではリード長が一定している必要があります。リード長がばらついているデータは、長さを揃える必要があります。
	 </ul>
	 
	<h2>bidirectional法での多型の検出</h2>
	  bidirectional法では、SNP以外に、挿入、欠失、逆位、転座等の構造変異も検出されます。<br>
	  <ul>
	  <li>perl bidirectional.pl ターゲット コントロール リファレンス<br>
	  例<br>
	  perl bidirectional.pl DRR054198 DRR099989 IRGSP1.0<br>
	  <li>この場合は、DRR054198のディレクトリ内に結果ファイルがセーブされます。<br>
	  比較対象のリードがなく、多型のマップ情報のみを得る場合は、<br>
	  perl bidirectional.pl DRR054198 default IRGSP1.0<br>
	  のように、controlの値をdefaultにすると、リファレンスゲノム自体をコントロールとしてカウントした結果が得られます。
	  <li>DRR054198のディレクトリには、<br>
	  DRR054198.aln.0<br>
	  DRR054198.aln.5<br>
	  DRR054198.aln.10<br>
	  DRR054198.aln.15<br>
	  DRR054198.bi.snp<br>
	  DRR054198.bi.vcf<br>
	  DRR054198.index<br>
	  DRR054198.sv<br>
	  が出力されます。<br>
	  snp情報は、DRR054198.bi.snpに独自フォーマットで出力され、確度の高いSNPがvcf形式でDRR054198.bi.vcfに出力されます。<br>
	  構造変異は、独自フォーマットでDRR054198.svに出力されます。<br>
	  DRR054198.alnはアラインメント結果で、リードの末端から0、5、10、15のマージンをとった20塩基の配列を用いてリファレンスゲノム上の位置を求めています。<br>
	  pedディレクトリで、<br>
	  perl search.pl DRR054198 1 1369483<br>
	  のように、perl search.pl target chr position<br>
	  を実行すると対応するアラインメントが検索され表示されます。<br>
	  </ul>
	<h2><i>k</i>-mer法での多型の検出</h2>
	  <i>k</i>-mer法は、SNPの検出のみとなります。
	  <ul>
	  <li>perl kmer.pl ターゲット コントロール リファレンス<br>
	  例<br>
	  perl kmer.pl  DRR054198 DRR099989 IRGSP1.0<br>
	  <li>この場合は、DRR054198のディレクトリ内に結果ファイルがセーブされます。<br>
	  比較対象のリードがなく、多型のマップ情報のみを得る場合は、<br>
	  perl kmer.pl DRR054198 default IRGSP1.0<br>
	  のように、controlの値をdefaultにすると、リファレンスゲノム自体をコントロールとしてカウントした結果が得られます。
	  </ul>
	<h2>グリッドエンジンを用いた並列計算</h2>
	  Torqueをインストールする必要があります。<br>
	  <ul>
	  <li>マルチコアのコンピュータの場合、スタンドアロンのコンピュータでも動作しますが、十分なメモリを搭載する必要があります。<br>
      メモリ不足でエラーになった場合は、qsub_が頭につかないスクリプトで解析する必要があります。<br>
	  Torqueのインストール方法は<a href = "https://github.com/akiomiyao/ped/wiki/Install-of-Torque" target = "_blank">こちら</a>。yumで簡単にインストールできます。<br>
      <li>CentOSを搭載した16CPU, 38GBのコンピュータにTorqueをインストールしてhg38ゲノムに対するヒトの多型データ検出に成功しています。
	  <li>perl qsub_mkref.pl リファレンス<br>
	  例 perl qsub_mkref.pl IRGSP1.0
	  <li>perl qsub_bidirectional.pl ターゲット コントロール リファレンス<br>
	  例 perl qsub_bidirectional.pl DRR054198 DRR099989 IRGSP1.0<br>
	  グリッドエンジンを用いて高速に計算することができます。
      <li>各ノードに1TB程度のSSDを搭載してテンポラリーディレクトリに指定するとより高速に処理ができます。<br>
      perl qsub_bidirectional.pl ターゲット コントロール リファレンス テンポラリーディレクトリ<br>
      perl qsub_bidirectional.pl DRR054198 DRR099989 IRGSP1.0 /mnt/ssd<br>
      のように実行します。リファレンスデータ等が /mnt/ssd にコピーされて保持されるのでマスター・ノード間のネットワークの負荷が軽減されます。<br>
      ヒトのデータしか解析しないような場合に利用すると効率的です。
      <li>農研機構高度解析センターのコンピュータクラスターを用いる場合は、<br>
    common.pl の中の<br>
    # $qsub_opt = "-S /usr/bin/perl -jc M.c8";<br>
    の行のコメントアウトを外して、<br>
    $qsub_opt = "-S /usr/bin/perl -jc M.c8";<br>
    としてセーブしなおしてから実行する必要があります。</ul>
    <a name = "example">
    <h2>解析事例</h2>
      <ul>
       <li>新型コロナウイルスのNGSデータからの多型検出
<pre>cd ped
perl download.pl accession=SRR11542243
perl ped.pl target=SRR11542243,ref=COVID19,clipping=100

miyao:~/ped/SRR11542243$ egrep 'H|M' SRR11542243.bi.snp
1       6312    C       A       50      0       0       68      M
1       6312    C       G       50      0       0       68      M
1       11083   G       T       50      0       0       15      M
1       11157   A       T       50      0       69      37      H
1       13730   C       T       50      0       0       62      M
1       19524   C       T       50      0       1       68      M
1       23929   C       T       50      0       1       72      M
1       26576   A       T       50      0       62      30      H

miyao:~/ped/SRR11542243$ egrep 'H|M' SRR11542243.sv
1       1208    1       1206    f       deletion        -1      50      0       92      43      H       AA
1       6049    1       6052    f       deletion        -7      50      0       92      50      H       TTT
1       6176    1       6176    f       deletion        -1      50      0       87      41      H       _
1       6701    1       6696    f       insertion       1       50      0       89      50      H       TTT
1       6781    1       6777    f       insertion       1       50      0       86      41      H       TT
1       9860    1       9641    r       inversion       N       50      0       19      13      H       ATGTGCTA
1       11083   1       11075   f       deletion        -1      50      0       0       48      M       TTTTTTTT
1       11185   1       11179   f       insertion       1       50      0       88      38      H       TTTT
1       11222   1       11221   f       deletion        -1      50      0       90      54      H       G
1       11297   1       11292   f       insertion       1       50      0       87      38      H       TTT
1       12114   1       12111   f       insertion       1       50      0       96      51      H       T
1       12135   1       12134   f       deletion        -2      50      0       96      53      H       TT
1       13081   1       13078   f       deletion        -1      50      0       85      44      H       TTT
1       15664   1       15660   f       insertion       1       50      0       90      54      H       TT
1       15677   1       15672   f       insertion       1       50      0       92      50      H       TTT
1       16094   1       16093   f       deletion        -1      50      0       86      38      H       T
1       16190   1       15688   f       insertion       502     50      0       36      31      H       G
1       17360   1       17364   f       deletion        -5      50      0       88      40      H       _
1       18692   1       18687   f       insertion       1       50      0       90      46      H       TTT
1       20913   1       20908   f       insertion       1       50      0       85      47      H       TTT
1       21950   1       21946   f       insertion       1       50      0       87      42      H       AA
1       22437   1       21967   f       insertion       467     50      0       20      41      H       TG
1       23561   1       23580   f       deletion        -22     50      0       95      43      H       TT
1       23561   1       23583   f       deletion        -23     50      0       95      55      H       _
1       23571   1       23582   f       deletion        -12     50      0       94      50      H       _
1       23584   1       23595   f       deletion        -14     50      0       94      42      H       TA
1       24378   1       24374   f       insertion       1       50      0       83      45      H       TT
1       24953   1       24954   f       deletion        -2      50      0       95      61      H       _
1       25404   1       25402   f       deletion        -1      50      0       94      43      H       TT
1       26660   1       26654   f       insertion       1       50      0       97      47      H       TTTT
1       26784   1       26816   f       deletion        -37     50      0       97      47      H       TCTT
1       26851   1       26629   f       insertion       221     50      0       57      45      H       _
1       27216   1       27215   f       deletion        -1      50      0       68      32      H       T
1       27226   1       27225   f       deletion        -1      50      0       75      41      H       G
1       27297   1       27297   f       deletion        -1      50      0       95      51      H       _
1       27444   1       27444   f       deletion        -2      50      0       87      40      H       T
1       29016   1       28340   f       insertion       675     50      0       32      17      H       _
1       29584   1       29581   f       deletion        -1      50      0       79      39      H       TTT
1       29703   1       29701   f       deletion        -1      50      0       78      42      H       GG

変異の確認例
miyao:~/ped$ perl search.pl SRR11542243 1 26784

# 1 26784 1 26816 f deletion -37
TGGATCACCGGTGGAATTGC GCGCGTACGCGTTCCATGTG 15
                                                      Chr1 26784
                                                      |
GTTTACAGAATAAATTGGATCACCGGTGGAATTGCTATCGCAATGGCTTGTCTTGTAGGCTTGATGTGGCTCAGCTACTTCATTGCTTCTTTCAGACTGT
||||||||||||||||||||||||||||||||||||||||||||||||||||||  || ||   || |  |  ||        || |  ||  |  | | 
GTTTACAGAATAAATTGGATCACCGGTGGAATTGCTATCGCAATGGCTTGTCTTTCAGACTGTTTGCGCGTACGCGTTCCATGTGGTCATTCAATCCAGA
    |  |  |    | |    |  |  |     |     |         ||||||||||||||||||||||||||||||||||||||||||||||||||
TCGCAATGGCTTGTCTTGTAGGCTTGATGTGGCTCAGCTACTTCATTGCTTCTTTCAGACTGTTTGCGCGTACGCGTTCCATGTGGTCATTCAATCCAGA
                                                 |
                                                 Chr1 26816

コロナウイルスの配列内に非常によく似た配列があり、塩基置換変異により見かけ上欠失が起こったように見える場合もあるので
注意深く検証する必要があります。


perl download.pl accession=SRR11542244
perl ped.pl target=SRR11542244,ref=COVID19,clipping=100

miyao:~/ped/SRR11542244$ egrep 'H|M' SRR11542244.bi.snp
1       9507    A       T       50      0       17      13      H
1       11104   T       C       50      0       0       72      M
1       12781   C       T       50      0       48      37      H
1       19255   C       T       50      0       24      18      H
1       24953   G       A       50      0       71      73      H

miyao:~/ped/SRR11542244$ egrep 'M|H' SRR11542244.sv
1       4155    1       4756    r       inversion       N       50      0       28      29      H       GGTGTTTTAA
1       5273    1       5271    f       deletion        -1      50      0       18      16      H       GG
1       5872    1       5870    f       deletion        -1      50      0       68      45      H       AA
1       9696    1       9698    f       deletion        -3      50      0       59      53      H       _
1       9860    1       9641    r       inversion       N       50      0       0       10      M       ATGTGCTA
1       11620   1       11616   f       insertion       1       50      0       53      27      H       TT
</pre>

RNA-Seqのfastqの配列データは鎖長が一定ではありません。<br>
PEDは一定の鎖長のデータが必要となるため、適当な長さに切りそろえる必要があります。<br>
鎖長の分布は、<br>
perl check_length.pl target=SRR11542243<br>
で確認することができます。<br>
SRR11542243は最大長が101塩基ですが、101塩基で指定するとサンプル数が少なくなるので、<br>
clipping=100で解析しています。この場合は、100塩基以上のリードが選ばれて、100塩基に切りそろえられてから解析されます。<br><br>
上記の2例は、マレーシアの患者から得られたウイルスですが、塩基置換以外に、挿入・欠失・逆位の変異も入っていることがわかります。<br>
また、100%変異型ではなく半分程度の変異が多く見られることから、感染後に個体内で変異を起こしながら増殖していることがわかります。<br>
また、おなじマレーシア国内で広がったコロナウイルスでも変異が独立していることから、非常に変異を起こしやすいウイルスであることがわかります。<br><br>

       <li>イネの早生・晩稲分離個体のバルク解析による関係領域の推定
         <ul>
          <li>日本稲の日本晴とインド型稲のカサラスを交配した個体の自殖個体(F2世代)は、出穂の表現型が早生と晩稲に分離する。<br>
              日本晴でバッククロスした個体の自殖個体の早生型と晩稲型の個体のバルクからのNGSデータを解析した。
          <li>早生データ: <a href = "https://www.ncbi.nlm.nih.gov/sra/?term=DRR056225" target = "_blank">DRR056225</a>
<a href = "https://www.ncbi.nlm.nih.gov/sra/?term=DRR056226" target = "_blank">DRR056226</a>、
晩稲データ: <a href = "https://www.ncbi.nlm.nih.gov/sra/?term=DRR056227" target = "_blank">DRR056227</a>
 <a href = "https://www.ncbi.nlm.nih.gov/sra/?term=DRR056228" target = "_blank">DRR056228</a>
 <a href = "https://www.ncbi.nlm.nih.gov/sra/?term=DRR056229" target = "_blank">DRR056229</a>
 <a href = "https://www.ncbi.nlm.nih.gov/sra/?term=DRR056230" target = "_blank">DRR056230</a>
          <li>pedディレクトリ下にearly/readとlate/readのディレクトリを作り、fastqデータをセーブする。<br>
              cd ped<br>
              mkdir early<br>
              mkdir early/read<br>
              mkdir late<br>
              mkdir late/read<br>
              mv DRR056225_1.fastq DRR056225_2.fastq DRR056226_1.fastq DRR056226_2.fastq early/read<br>
              mv DRR056227_1.fastq DRR056227_2.fastq DRR056228_1.fastq DRR056228_2.fastq DRR056229_1.fastq DRR056229_2.fastq DRR056230_1.fastq DRR056230_2.fastq late/read<br>
           <li>イネのリファレンスデータを作り、bidirectional法で多型情報を取得する。<br>
              perl mkref.pl IRGSP1.0<br>
              perl bidirectional.pl early late IRGSP1.0
           <li>イネの全配列長を1000当分して、各ブロックに存在する早生型、晩稲型で検出されたSNP座位数を調べて、晩稲型SNP数 - 早生型SNP数をプロットした。<br>
              <a href = "delta.png" target = "_blank"><img src = "delta.png" width = "10%"></a>
           <li>第6染色体の上腕部分に早生型で検出されるSNPが多く検出され、その後に晩稲型SNPが多く検出される領域が続いている。<br>
               この領域にそれぞれ早生、晩稲に関与する遺伝子座が存在する。
           <li>文献: <a href = "https://www.jstage.jst.go.jp/article/jsbbs/67/2/67_16096/_article" target = "_blank">Detection of novel QTLs qDTH4.5 and qDTH6.3, which confer late heading under short-day conditions, by SSR marker-based and QTL-seq analysis. Breed Sci. 67(2):101-109 (2017).</a>
           <li><a href = "https://github.com/akiomiyao/ped/wiki/Bulked-segrigant-analysis-of-rice" target = "_blank">英文リンク</a>
         </ul>
         <li>ヒトの多型検出
         <ul>
           <li>perl mkref.pl hg38<br>
           を実行してリファレンスを作る。
           <li>perl download.pl ERR194146<br>
           で、<a href = "https://www.ncbi.nlm.nih.gov/Traces/study/?acc=ERP001960&o=acc_s%3Aa" target = "_blank">CEPH/UTAH家系の父親のfastqデータ</a>をダウンロードする。<br>
           どういうわけか、最近息子のERR194152の配列がNCBI/SRAからダウンロードできなくなった。母親ERR194147は今のところダウンロード可能である。
           <li>高度解析センターのclusterを用いた場合の実行ログ<pre>[miyao@cluster1 ped]$ perl qsub_bidirectional.pl ERR194146 default hg38
2019年 10月 16日 水曜日 16:30:24 JST Making ERR194146.sort_uniq.
2019年 10月 17日 木曜日 10:48:55 JST Aligning of ERR194146 sequence to hg38 genome.
2019年 10月 18日 金曜日 06:42:16 JST Splitting of Indel alignment.
2019年 10月 18日 金曜日 06:42:17 JST Splitting of SNP alignment.
2019年 10月 18日 金曜日 08:52:26 JST Verifying indel 01
2019年 10月 18日 金曜日 08:52:27 JST Verifying SNPs 01
2019年 10月 18日 金曜日 08:52:28 JST Verifying SNPs 02
2019年 10月 18日 金曜日 08:52:29 JST Verifying SNPs 03
2019年 10月 18日 金曜日 08:52:30 JST Verifying SNPs 04
2019年 10月 18日 金曜日 08:52:31 JST Verifying SNPs 05
2019年 10月 18日 金曜日 08:52:32 JST Verifying SNPs 06
2019年 10月 18日 金曜日 08:52:33 JST Verifying SNPs 07
2019年 10月 18日 金曜日 08:52:34 JST Verifying SNPs 08
2019年 10月 18日 金曜日 08:52:35 JST Verifying SNPs 09
2019年 10月 18日 金曜日 08:52:36 JST Verifying SNPs 10
2019年 10月 18日 金曜日 08:52:37 JST Verifying SNPs 11
2019年 10月 18日 金曜日 08:52:38 JST Verifying SNPs 12
2019年 10月 18日 金曜日 08:52:39 JST Verifying SNPs 13
2019年 10月 18日 金曜日 08:52:40 JST Verifying SNPs 14
2019年 10月 18日 金曜日 08:52:41 JST Verifying SNPs 15
2019年 10月 18日 金曜日 18:45:48 JST Making vcf file of SNP
2019年 10月 18日 金曜日 18:48:58 JST bidirectional.pl complete.</pre>
           <li>16 core、38GBの1台のコンピュータにTorqueをインストールして実行した所要時間は以下の通り。<pre>
[miyao@s2 ped]$ perl qsub_bidirectional.pl ERR194146 default hg38
Mon Dec  2 23:30:45 JST 2019 Aligning of ERR194146 sequence to hg38 genome
Tue Dec  3 20:47:06 JST 2019 Indexing of alignment
Tue Dec  3 20:47:07 JST 2019 Splitting of Indel alignment
Tue Dec  3 20:47:08 JST 2019 Splitting of SNP alignment
Tue Dec  3 21:10:11 JST 2019 Verifying indel 01
Tue Dec  3 21:10:12 JST 2019 Verifying SNPs 01
Tue Dec  3 21:10:13 JST 2019 Verifying SNPs 02
Tue Dec  3 21:10:14 JST 2019 Verifying SNPs 03
Tue Dec  3 21:10:16 JST 2019 Verifying SNPs 04
Tue Dec  3 21:10:17 JST 2019 Verifying SNPs 05
Tue Dec  3 21:10:18 JST 2019 Verifying SNPs 06
Tue Dec  3 21:10:19 JST 2019 Verifying SNPs 07
Tue Dec  3 21:10:20 JST 2019 Verifying SNPs 08
Tue Dec  3 21:10:21 JST 2019 Verifying SNPs 09
Tue Dec  3 21:10:22 JST 2019 Verifying SNPs 10
Tue Dec  3 21:10:23 JST 2019 Verifying SNPs 11
Tue Dec  3 21:10:24 JST 2019 Verifying SNPs 12
Tue Dec  3 21:10:25 JST 2019 Verifying SNPs 13
Tue Dec  3 21:10:26 JST 2019 Verifying SNPs 14
Tue Dec  3 21:10:27 JST 2019 Verifying SNPs 15
Wed Dec  4 19:19:06 JST 2019 Making vcf file of SNP
Wed Dec  4 19:21:32 JST 2019 bidirectional.pl complete.
</pre>
    </ul>
    </ul>
    <h2>PEDに関する資料</h2>
      <ul>
       <li>スクリプト: <a href = "https://github.com/akiomiyao/ped/" "_blank">https://github.com/akiomiyao/ped/</a>
       <li>論文: <a href = "https://doi.org/10.1186/s12859-019-2955-6" target = "_blank">Polymorphic edge detection (PED): two efficient methods of polymorphism detection from next-generation sequencing data (2019) BMC Bioinformatics 20(1):362</a>
      </ul> 
    <h2>その他のお役立ち情報</h2>
      <ul>
      <li>NGSデータから転移したトランスポゾンを検出する方法 <a href = "https://github.com/akiomiyao/tif/" target = "_blank">Transposon Insertion Finder (TIF)</a>
      <li>ミュータントパネルデータベース <a href = "https://tos.nias.affrc.go.jp" target = "_blank">https://tos.nias.affrc.go.jp</a> 
      </ul>
    <h2>現在取扱いをしている企業について</h2>
    ご自分で解析が困難な場合は、このソフトウェアを用いた解析を受託会社に依頼することもできます。
      <ul>
      <li><a href = "https://gikenbio.com/" target = "_blank">株式会社生物技研</a>
      <li>つくば遺伝子研究所
      </ul>
     研究目的での利用はご自由に利用してもらって大丈夫ですが、企業の方で営利目的の場合は、農研機構知的財産部特許ライセンスチーム (電話 029-838-6465 メール <a href = "mailto:naro-kyodaku@naro.affrc.go.jp">naro-kyodaku@naro.affrc.go.jp</a>)にご連絡ください。
    <h2>お問い合わせ先</h2>
    〒305-8518<br>
    茨城県つくば市観音台2-1-2<br>
    <a href = "http://www.naro.affrc.go.jp/" target = "_blank">農研機構</a>次世代作物開発研究センター<br>
    宮尾安藝雄 (<a href = "mailto:miyao@affrc.go.jp">miyao@affrc.go.jp</a>)<br>
    </body>
</html>
