<html>
  <head>
    <meta charset = "utf-8">
    <link rel = "stylesheet" href = "default.css">
  <head>
    <body>
      <h1>NGS解析の手引</h1>
      <h2>PEDを用いた多型検出</h2>
      Unix (Linux)がインストールされたコンピュータでの作業となります。
      <ul>
	<li>プログラムのダウンロード<br>
	  <a href = "https://github.com/akiomiyao/ped" target = "_blank">https://github.com/akiomiyao/ped</a>にアクセスして、<br>
	  Clone or downloadのプルダウンメニューよりzipファイルをダウンロードする。あるいは、<br>
	  git clone https://github.com/akiomiyao/ped<br>
	  を実行する。
	<li>以後の作業は、展開されたpedあるいはped-masterのディレクトリで作業する。git cloneで展開した場合は、展開したディレクトリで<br>
	  git pull<br>
	  を実行すると、最新のスクリプトに同期される。
	<li>リファレンスゲノムデータセットの作成<br>
	  perl mkref.pl<br>
	  引数なしで実行するとヘルプと対応しているゲノムがリストされる。<br>
	  perl mkref.pl IRGSP1.0<br>
	  を実行するとイネ(日本晴)データセットができる。<br>
	  IRGSP1.0をhg38にするとヒトのデータセットができる。<br>
	  ヒトの場合はサイズが大きいので、作成に1日程度かかる。<br>
	<li>fastq-dumpのインストール<br>
	  <a href = "https://trace.ncbi.nlm.nih.gov/Traces/sra/sra.cgi?view=software" target = "_blank">https://trace.ncbi.nlm.nih.gov/Traces/sra/sra.cgi?view=software</a><br>
	  から、コンパイルされた実行ファイルのアーカイブをダウンロードする。<br>
	  OSがCentOSなら、CentOS Linux 64 bit architecture - non-sudo tar archiveをダウンロードする。<br>
	  tar xvzf ファイル名 で展開できる。
	  tar xvzf sratoolkit.2.10.0-centos_linux64.tar.gz<br>
	  展開されたディレクトリの中のbinの中にある、fastq-dump-orig.2.10.0をユーザのホームディレクトリのbinディレクトリにfastq-dumpというファイル名でコピーする。<br>
	  例<br>
	  cp sratoolkit.2.10.0-centos_linux64/bin/fastq-dump-orig.2.10.0 ~/bin/fastq-dump
	<li>Fastqデータの取得<br>
	  日本晴 DRR099989<br>
	  コシヒカリ DRR054198<br>
	  perl download.pl DRR099989<br>
	  perl download.pl DRR054198<br>
	  pedのディレクトリの中に、DRR054198とDRR099989のディレクトリが作成され、その中のreadのディレクトリの中にfastqファイルがダウンロードされる。<br>
	  fastqファイルは、gz形式やbz2形式で圧縮されていても、そのまま解析が可能である。<br>
	  ターゲット名のディレクトリ下のreadディレクトリの中に置いたファイルがまとめて解析される。<br>
	  ペアエンドのデータでも複数のシングルエンドのデータでも解析されるが、ファイルの圧縮形式は揃っている必要がある。<br>
	  PEDではリード長が一定している必要がある。リード長がばらついているデータは、長さを揃える必要がある。<br>
	<li>bidirectional法での多型の検出<br>
	  perl bidirectional.pl ターゲット コントロール リファレンス<br>
	  例<br>
	  perl bidirectional.pl DRR054198 DRR099989 IRGSP1.0<br>
	  この場合は、DRR054198のディレクトリ内に結果ファイルがセーブされる。<br>
	  比較対象のリードがなく、多型のマップ情報のみを得る場合は、<br>
	  perl bidirectional.pl DRR054198 default IRGSP1.0<br>
	  のように、controlの値をdefaultにすると、リファレンスゲノム自体をコントロールとしてカウントした結果が得られる。
	<li>グリッドエンジンを用いた並列計算
	  Torqueをインストールする必要がある。<br>
	  マルチコアのコンピュータの場合、スタンドアロンのコンピュータでも有効であるが、十分なメモリを搭載する必要がある。<br>
	  Torqueのインストール方法は<a href = "https://github.com/akiomiyao/ped/wiki/Install-of-Torque" target = "_blank">こちら</a>。<br>
	  perl qsub_bidirectional.pl DRR054198 DRR099989 IRGSP1.0<br>
	  グリッドエンジンを用いて高速に計算することができる。
      </ul>
    </body>
</html>
